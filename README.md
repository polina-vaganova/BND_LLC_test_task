# BND_LLC — тестовое задание

## О проекте

Скрипт детектирует людей на видео и сохраняет аннотированное видео.
Выделенные объекты содержат название класса (person) и уверенность (confidence).

## Требования проекту

- pip
- GNU Make
- Python 3.8+

## Подготовка проекта

1) Пропишите команду: `make check`, чтобы проверить наличие нужных инструментов: *GNU Make*, *Python*.
2) Пропишите команду `make install`, чтобы создать виртуальное окружение *Python* и установить необходимые *Python* пакеты.

## Запуск программы

Производить из корня проекта.

1) Для начала активируйте виртуальное окружение командой: `.venv\Scripts\activate` для OS *Windows* или `source .venv/bin/activate` для OS *MacOS*/*Ubuntu*.
2) Комманда для запуска: `python src/main.py --input data/video/raw/crowd.mp4 --output data/video/processed/detecterd_crowd.mp4 --model yolov8n.pt --conf 0.25`

где:
    - `python` - Ваш интерпретатор *Python*.
    - `src\main.py` - точка запуска программы.
    - `--input data/video/raw/crowd.mp4` - входное видео для обработки.
    - `--output data/video/processed/detecterd_crowd.mp4` - обработанное видео.
    - `--model yolov8n.pt` - настроенная модель для обработки видео.
    - `--conf 0.25` - доверительный порог модели. Принимает значения от `0` до `1`.

## Очистка проекта

Для очистки проекта:

1) Выйдите из виртуалного окружения *Python* командой: `.venv\Scripts\deactivate` для OS *Windows* или `deactivate .venv` для OS *MacOS*/*Ubuntu*.
2) Использовать команду: `make clear`.

## Возможные улучшения

Нейросеть в некоторых случаях может принять картины и куртки за человека. Когда человека начинает что-то перекрывать, нейросеть может его перестать определять. Следующие возможные шаги по улучшению работы модели:

1. Улучшение данных

- Более качественная аннотация: Обеспечение правильной разметки всех людей в датасете, включая частично загораживаемых.
- Добавление отрицательных примеров: Включение в датасет изображений предметов, которые модель путает с людьми, с пометкой "не человек".
- Аугментация данных:
    - Применение частичного перекрытия людей другими объектами.
    - Использование разных ракурсов, освещения, масштаба.
    - Введение шума или размытия.
- Баланс классов: Обеспечение достаточного количества примеров людей по сравнению с другими объектами.

2. Архитектурные подходы

- Использование более мощной или специализированной модели: Рассмотрение моделей с улучшенной детекцией мелких или перекрытых объектов.
- Применение feature pyramid / multi-scale detection: Для улучшения распознавания объектов разных размеров.
- Использование сегментации: Применение сегментационных моделей для лучшего анализа формы и контуров частично скрытых объектов.

3. Методы постобработки

- Настройка Non-Maximum Suppression (NMS): Адаптация порога для сохранения частично перекрытых объектов.
- Применение temporal smoothing для видео: Поддержка "существования" объекта при кратковременном перекрытии.
- Использование трекинга: Интеграция алгоритмов трекинга для отслеживания людей при их частичном загораживании.

4. Обратная связь и обучение на ошибках

- Применение hard negative mining: Добавление в датасет объектов, которые модель ошибочно принимает за человека.
- Организация онлайн дообучения: Дообучение модели на специфических случаях из вашего видеопотока.

5. Комбинированные подходы

- Использование ensemble моделей: Комбинация предсказаний нескольких моделей с разной архитектурой.
- Применение мультизадачного обучения: Одновременное обучение детекции и сегментации или классификации позы.